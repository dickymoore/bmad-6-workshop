<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>4</epicId>
    <storyId>4.3</storyId>
    <title>Toasts and inline feedback</title>
    <status>drafted</status>
    <generatedAt>2025-12-03</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/4-3-toasts-and-inline-feedback.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>user</asA>
    <iWant>clear success/error messages for actions</iWant>
    <soThat>I know what happened</soThat>
    <tasks>
      <![CDATA[
      - Centralize feedback utility; standardize copy for create/cancel/export/import; map structured errors (AC1–AC3)
      - Ensure toasts are accessible (role="status"), focusable when needed; consistent tone (AC2)
      - Wire feedback into booking create/cancel, backup export, import; inline errors where appropriate (AC1–AC3)
      - Tests: success/error toasts show; inline errors render; errors not swallowed
      ]]>
    </tasks>
  </story>

  <acceptanceCriteria>
    <![CDATA[
    1) All create/cancel/export/import actions show success toasts; errors show toast + inline message. (docs/epics.md)
    2) Toasts use consistent copy/tone and are accessible (role="status"). (docs/prd.md)
    3) Errors propagate structured messages from helpers; no silent failures. (docs/architecture.md)
    ]]>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <![CDATA[
      - path: docs/epics.md; title: Epics; section: Epic 4 Story 4.3; snippet: feedback requirements.
      - path: docs/prd.md; title: PRD; section: FR18; snippet: confirmation/error messaging requirement.
      - path: docs/architecture.md; title: Architecture; section: Error handling; snippet: structured errors from storage/helpers.
      ]]>
    </docs>
    <code>
      <![CDATA[
      - None yet; implement feedback utility and wire to actions.
      ]]>
    </code>
    <dependencies>
      <![CDATA[
      - React 19.2.x
      - Vite 6.2.x
      - Radix UI 1.2.x (Toast)
      ]]>
    </dependencies>
  </artifacts>

  <constraints>
    <![CDATA[
    - Do not swallow errors; map structured errors to user-facing copy.
    - Ensure role="status" and focus handling for accessibility.
    - Keep copy consistent across actions.
    ]]>
  </constraints>

  <interfaces>
    <![CDATA[
    - showToast(type, message, meta?)
    - showInlineError(targetId, message)
    - mapErrorToMessage(error): string
    ]]>
  </interfaces>

  <tests>
    <standards><![CDATA[React Testing Library + axe; unit tests for error mapping.]]></standards>
    <locations><![CDATA[tests/unit/feedback.test.ts, tests/component/Feedback.spec.tsx]]></locations>
    <ideas><![CDATA[
    - AC1: Actions trigger toast + inline error on failure; success toast on success.
    - AC2: Toast has role="status" and consistent copy.
    - AC3: Structured errors mapped; unknown errors still surfaced, not swallowed.
    ]]></ideas>
  </tests>
</story-context>
